{% extends "base.html" %}

{% block title %}Di·ªÖn ƒë√†n{% endblock %}

{% block content %}
<style>
    /* CSS cho layout 2 c·ªôt */
    .home-grid {
        display: grid;
        grid-template-columns: 1fr; /* M·∫∑c ƒë·ªãnh 1 c·ªôt cho mobile */
        gap: 24px;
    }

    @media (min-width: 768px) {
        .home-grid {
            /* 2 c·ªôt tr√™n desktop: c·ªôt ch√≠nh 70%, c·ªôt ph·ª• 30% */
            grid-template-columns: 2.5fr 1fr; 
        }
    }

    .sidebar-card {
        background-color: var(--color-surface);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-card);
        border: 1px solid var(--color-border);
        padding: 1.25rem;
        margin-bottom: 1.5rem;
    }
    .sidebar-header {
        font-size: 1rem;
        font-weight: 600;
        color: var(--color-text-primary);
        margin-bottom: 1rem;
    }
    .category-list a {
        display: block;
        padding: 8px 0;
        text-decoration: none;
        color: var(--color-accent);
        font-size: 15px;
        border-bottom: 1px solid #eee;
    }
    .stats-list div {
        font-size: 15px;
        color: var(--color-text-secondary);
        padding: 5px 0;
        display: flex;
        justify-content: space-between;
    }
    
    /* CSS M·ªöI CHO WELCOME BOX */
    .welcome-box {
        background-color: var(--color-surface);
        border-radius: var(--radius-lg);
        box-shadow: var(--shadow-card);
        border: 1px solid var(--color-border);
        padding: 1.5rem;
        margin-bottom: 1.5rem;
    }
    .welcome-box h1 {
        font-size: 1.25rem;
        font-weight: 600;
        margin-top: 0;
        color: var(--color-text-primary);
    }
    .welcome-box p {
        font-size: 0.95rem;
        color: var(--color-text-secondary);
        line-height: 1.6;
    }
</style>

<div class="home-grid">
    
    <div class="main-content">

        <div class="welcome-box">
            <h1>Ch√†o m·ª´ng ƒë·∫øn v·ªõi Di·ªÖn ƒë√†n Nh√≥m 8_2FA</h1>
            {% if request.user.is_authenticated %}
                <p>
                    Ch√†o m·ª´ng, <strong>{{ request.user.username }}</strong>.
                    H√£y xem c√°c ho·∫°t ƒë·ªông m·ªõi nh·∫•t b√™n d∆∞·ªõi ho·∫∑c
                    <a href="{% url 'forum:thread_create' %}">t·∫°o m·ªôt ch·ªß ƒë·ªÅ m·ªõi</a>.
                </p>
            {% else %}
                <p>
                    ƒê√¢y l√† d·ª± √°n demo Kh√≥a lu·∫≠n C·ª≠ nh√¢n v·ªÅ An to√†n th√¥ng tin,
                    t·∫≠p trung v√†o vi·ªác x√¢y d·ª±ng c∆° ch·∫ø x√°c th·ª±c hai y·∫øu t·ªë (2FA) k·∫øt h·ª£p OTP.
                    Vui l√≤ng <a href="{% url 'accounts:login' %}">ƒêƒÉng nh·∫≠p</a>
                    ho·∫∑c <a href="{% url 'accounts:register' %}">ƒêƒÉng k√Ω</a> ƒë·ªÉ tham gia.
                </p>
            {% endif %}
        </div>
        <h2 style="font-size:16px; font-weight:600; color:var(--text-primary); margin-bottom:16px;">
            Ho·∫°t ƒë·ªông m·ªõi nh·∫•t
        </h2>

        {% for thread in latest_threads %}
            <a class="thread-card" href="{{ thread.get_absolute_url }}">
                <div class="thread-title">{{ thread.title }}</div>
                <div class="thread-meta">
                    B·ªüi 
                    <strong>{{ thread.author.username }}</strong>
                    trong
                    <strong>{{ thread.category.title }}</strong>
                    ‚Ä¢ {{ thread.created_at|date:"H:i d/m/Y" }}
                </div>
            </a>
        {% empty %}
            <div class="thread-card">
                <div class="thread-title">Ch∆∞a c√≥ ch·ªß ƒë·ªÅ n√†o.</div>
            </div>
        {% endfor %}
    </div>

    <div class="sidebar">
        
        <div class="sidebar-card">
            <div class="sidebar-header">Chuy√™n m·ª•c</div>
            <div class="sidebar-category-list">
                {% for category in categories %}
                    <a href="{{ category.get_absolute_url }}">
                        <span class="icon">üìÅ</span> {{ category.title }}
                    </a>
                {% empty %}
                    <small style="color:var(--color-text-secondary);">Ch∆∞a c√≥ chuy√™n m·ª•c.</small>
                {% endfor %}
            </div>
        </div>
        
        <div class="sidebar-card">
            <div class="sidebar-header">Ho·∫°t ƒë·ªông m·ªõi nh·∫•t</div>
            <div class="sidebar-latest-activity">
                {% for thread in latest_threads_sidebar %}
                    <a href="{{ thread.get_absolute_url }}">
                        <div class="thread-title">{{ thread.title }}</div>
                        <div class="thread-meta">
                            B·ªüi <strong>{{ thread.author.username }}</strong> ‚Ä¢ {{ thread.created_at|date:"d/m/Y" }}
                        </div>
                    </a>
                {% empty %}
                    <small style="color:var(--color-text-secondary);">Ch∆∞a c√≥ ho·∫°t ƒë·ªông n√†o.</small>
                {% endfor %}
            </div>
        </div>
        
        <div class="sidebar-card">
            <div class="sidebar-header">Th·ªëng k√™</div>
            <div class="sidebar-stats-list">
                <div>
                    <span>Th√†nh vi√™n:</span>
                    <strong>{{ stats.total_users }}</strong>
                </div>
                <div>
                    <span>Ch·ªß ƒë·ªÅ:</span>
                    <strong>{{ stats.total_threads }}</strong>
                </div>
                <div>
                    <span>B√†i vi·∫øt:</span>
                    <strong>{{ stats.total_posts }}</strong>
                </div>
            </div>
        </div>
    </div>
    </div>
{% endblock %}